{"ast":null,"code":"import React,{useState}from\"react\";import{useNavigate,Link}from\"react-router-dom\";import axios from\"axios\";import{useUser}from\"../contexts/UserContext\";import\"./index.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const faculties=[\"Informatique\",\"Gestion\",\"Sciences de l'ingénieur\",\"Lettres et sciences humaines\",\"Sciences de la santé\",\"Polytechnique\",\"Études de la Bible\",\"Agronomie\",\"Droit\",\"Économie\"];const Index=()=>{const{setUser}=useUser();const navigate=useNavigate();const[loginForm,setLoginForm]=useState({matricule:\"\",password:\"\",role:\"\",faculty:\"\"});const[loginError,setLoginError]=useState(\"\");const handleLogin=async e=>{e.preventDefault();setLoginError(\"\");try{const response=await axios.post(\"http://localhost:3001/api/auth/login\",{matricule:loginForm.matricule,password:loginForm.password,faculty:loginForm.faculty,role:loginForm.role});const user=response.data.user;if(user.role!==loginForm.role){setLoginError(\"Rôle incorrect pour cet utilisateur.\");return;}setUser(user);const facSlug=user.faculty.toLowerCase().replace(/\\s+/g,\"-\");navigate(`/dashboard/${facSlug}/${user.role}`);}catch(error){var _error$response,_error$response$data;console.error(\"Erreur de connexion :\",error);const message=((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||\"Nom, mot de passe ou faculté incorrect.\";setLoginError(message);}};return/*#__PURE__*/_jsx(\"div\",{className:\"login-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"login-header\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://i.postimg.cc/mZwbqh7Z/1752262954454.jpg\",alt:\"logo UPL\",width:\"60\",height:\"60\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"login-title\",children:\"Connexion\"}),/*#__PURE__*/_jsx(\"p\",{className:\"login-description\",children:\"Acc\\xE9dez \\xE0 votre espace personnel\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleLogin,className:\"login-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"R\\xF4le\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form-select\",children:/*#__PURE__*/_jsxs(\"select\",{value:loginForm.role,onChange:e=>setLoginForm({...loginForm,role:e.target.value}),className:\"select-trigger\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Choisir un r\\xF4le\"}),/*#__PURE__*/_jsx(\"option\",{value:\"student\",children:\"\\xC9tudiant\"}),/*#__PURE__*/_jsx(\"option\",{value:\"teacher\",children:\"Professeur\"}),/*#__PURE__*/_jsx(\"option\",{value:\"admin\",children:\"Administration\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Facult\\xE9\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form-select\",children:/*#__PURE__*/_jsxs(\"select\",{value:loginForm.faculty,onChange:e=>setLoginForm({...loginForm,faculty:e.target.value}),className:\"select-trigger\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Choisir une facult\\xE9\"}),faculties.map(f=>/*#__PURE__*/_jsx(\"option\",{value:f,children:f},f))]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Matricule\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-input\",value:loginForm.matricule,onChange:e=>setLoginForm({...loginForm,matricule:e.target.value}),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Mot de passe\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-input\",value:loginForm.password,onChange:e=>setLoginForm({...loginForm,password:e.target.value}),required:true})]}),loginError&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:loginError}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"login-button\",children:\"Se connecter\"}),/*#__PURE__*/_jsx(\"div\",{className:\"login-link\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Pas encore de compte ?\",\" \",/*#__PURE__*/_jsx(Link,{to:\"/register\",children:\"Cr\\xE9er un compte\"})]})})]})]})});};export default Index;","map":{"version":3,"names":["React","useState","useNavigate","Link","axios","useUser","jsx","_jsx","jsxs","_jsxs","faculties","Index","setUser","navigate","loginForm","setLoginForm","matricule","password","role","faculty","loginError","setLoginError","handleLogin","e","preventDefault","response","post","user","data","facSlug","toLowerCase","replace","error","_error$response","_error$response$data","console","message","className","children","src","alt","width","height","onSubmit","value","onChange","target","required","map","f","type","to"],"sources":["C:/Users/HP/Desktop/upl.patforme/frontend/src/pages/index.tsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { useNavigate, Link } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport { useUser } from \"../contexts/UserContext\";\r\nimport \"./index.css\";\r\n\r\nconst faculties = [\r\n  \"Informatique\",\r\n  \"Gestion\",\r\n  \"Sciences de l'ingénieur\",\r\n  \"Lettres et sciences humaines\",\r\n  \"Sciences de la santé\",\r\n  \"Polytechnique\",\r\n  \"Études de la Bible\",\r\n  \"Agronomie\",\r\n  \"Droit\",\r\n  \"Économie\",\r\n];\r\n\r\nconst Index: React.FC = () => {\r\n  const { setUser } = useUser();\r\n  const navigate = useNavigate();\r\n\r\n  const [loginForm, setLoginForm] = useState({\r\n    matricule: \"\",\r\n    password: \"\",\r\n    role: \"\",\r\n    faculty: \"\",\r\n  });\r\n\r\n  const [loginError, setLoginError] = useState(\"\");\r\n\r\n  const handleLogin = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoginError(\"\");\r\n\r\n    try {\r\n      const response = await axios.post(\"http://localhost:3001/api/auth/login\", {\r\n        matricule: loginForm.matricule,\r\n        password: loginForm.password,\r\n        faculty: loginForm.faculty,\r\n        role: loginForm.role,\r\n      });\r\n\r\n      const user = response.data.user;\r\n\r\n      if (user.role !== loginForm.role) {\r\n        setLoginError(\"Rôle incorrect pour cet utilisateur.\");\r\n        return;\r\n      }\r\n\r\n      setUser(user);\r\n\r\n      const facSlug = user.faculty.toLowerCase().replace(/\\s+/g, \"-\");\r\n      navigate(`/dashboard/${facSlug}/${user.role}`);\r\n    } catch (error: any) {\r\n      console.error(\"Erreur de connexion :\", error);\r\n      const message =\r\n        error.response?.data?.message || \"Nom, mot de passe ou faculté incorrect.\";\r\n      setLoginError(message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"login-container\">\r\n      <div className=\"login-card\">\r\n        <div className=\"login-header\">\r\n          <img src=\"https://i.postimg.cc/mZwbqh7Z/1752262954454.jpg\"alt=\"logo UPL\" width=\"60\" height=\"60\" ></img>\r\n          <h1 className=\"login-title\">Connexion</h1>\r\n          <p className=\"login-description\">Accédez à votre espace personnel</p>\r\n        </div>\r\n        \r\n        <form onSubmit={handleLogin} className=\"login-form\">\r\n          {/* Rôle */}\r\n          <div className=\"form-group\">\r\n            <label className=\"form-label\">Rôle</label>\r\n            <div className=\"form-select\">\r\n              <select\r\n                value={loginForm.role}\r\n                onChange={(e) => setLoginForm({...loginForm, role: e.target.value})}\r\n                className=\"select-trigger\"\r\n                required\r\n              >\r\n                <option value=\"\">Choisir un rôle</option>\r\n                <option value=\"student\">Étudiant</option>\r\n                <option value=\"teacher\">Professeur</option>\r\n                <option value=\"admin\">Administration</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Faculté */}\r\n          <div className=\"form-group\">\r\n            <label className=\"form-label\">Faculté</label>\r\n            <div className=\"form-select\">\r\n              <select\r\n                value={loginForm.faculty}\r\n                onChange={(e) => setLoginForm({...loginForm, faculty: e.target.value})}\r\n                className=\"select-trigger\"\r\n                required\r\n              >\r\n                <option value=\"\">Choisir une faculté</option>\r\n                {faculties.map((f) => (\r\n                  <option key={f} value={f}>{f}</option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Matricule */}\r\n          <div className=\"form-group\">\r\n            <label className=\"form-label\">Matricule</label>\r\n            <input\r\n              type=\"text\"\r\n              className=\"form-input\"\r\n              value={loginForm.matricule}\r\n              onChange={(e) => setLoginForm({...loginForm, matricule: e.target.value})}\r\n              required\r\n            />\r\n          </div>\r\n\r\n          {/* Mot de passe */}\r\n          <div className=\"form-group\">\r\n            <label className=\"form-label\">Mot de passe</label>\r\n            <input\r\n              type=\"password\"\r\n              className=\"form-input\"\r\n              value={loginForm.password}\r\n              onChange={(e) => setLoginForm({...loginForm, password: e.target.value})}\r\n              required\r\n            />\r\n          </div>\r\n\r\n          {/* Affichage erreur */}\r\n          {loginError && <p className=\"error-message\">{loginError}</p>}\r\n\r\n          {/* Bouton de connexion */}\r\n          <button type=\"submit\" className=\"login-button\">\r\n            Se connecter\r\n          </button>\r\n\r\n          {/* Lien inscription */}\r\n          <div className=\"login-link\">\r\n            <p>\r\n              Pas encore de compte ?{\" \"}\r\n              <Link to=\"/register\">Créer un compte</Link>\r\n            </p>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Index;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}