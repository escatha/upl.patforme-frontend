{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useParams}from\"react-router-dom\";import{useUser}from\"../contexts/UserContext\";import QuestionnaireList from\"../components/QuestionnaireList\";import\"./admi.css\";import{Card,CardContent,CardDescription,CardHeader,CardTitle}from\"../components/ui/card\";import{Button}from\"../components/ui/button\";import{Input}from\"../components/ui/input\";import{Label}from\"../components/ui/label\";import{Tabs,TabsContent,TabsList,TabsTrigger}from\"../components/ui/tabs\";import{LogOut,Calendar,Download}from\"lucide-react\";import{useToast}from\"../hooks/use-toast\";import*as XLSX from\"xlsx\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const AdminDashboard=_ref=>{let{user,onLogout}=_ref;const formatDate=dateString=>{if(!dateString)return\"Date non disponible\";const date=new Date(dateString);return isNaN(date.getTime())?\"Date invalide\":date.toLocaleString();};const{faculty}=useParams();const{setUser}=useUser();const[questionnaires,setQuestionnaires]=useState([]);const[exams,setExams]=useState([]);const[results,setResults]=useState([]);const[selectedQuestionnaire,setSelectedQuestionnaire]=useState(null);const[examForm,setExamForm]=useState({duration:60,startTime:\"\",endTime:\"\",title:\"\",subject:\"\"});const[isSchedulingExam,setIsSchedulingExam]=useState(false);const[currentPage,setCurrentPage]=useState(1);const[itemsPerPage]=useState(5);const[isLoading,setIsLoading]=useState({exams:false,questionnaires:false,results:false,users:false});const{toast}=useToast();const fetchExams=async()=>{setIsLoading(prev=>({...prev,exams:true}));try{const res=await fetch(`http://localhost:3001/api/exams?faculty=${user.faculty}`);if(!res.ok)throw new Error(\"Échec du chargement des examens\");const data=await res.json();setExams(data);}catch(error){console.error(\"Erreur lors du chargement des examens:\",error);toast({title:\"Erreur\",description:\"Impossible de charger les examens\",variant:\"destructive\"});}finally{setIsLoading(prev=>({...prev,exams:false}));}};useEffect(()=>{fetchExams();},[]);const fetchQuestionnaires=async()=>{setIsLoading(prev=>({...prev,questionnaires:true}));try{const res=await fetch(\"http://localhost:3001/api/questionnaires/submitted\",{headers:{'Authorization':`Bearer ${localStorage.getItem('token')}`}});if(!res.ok)throw new Error(\"Échec du chargement des questionnaires\");const data=await res.json();setQuestionnaires(data);}catch(err){console.error(\"Erreur de chargement:\",err);toast({title:\"Erreur\",description:\"Impossible de charger les questionnaires\",variant:\"destructive\"});}finally{setIsLoading(prev=>({...prev,questionnaires:false}));}};useEffect(()=>{fetchQuestionnaires();},[]);const fetchResults=async()=>{setIsLoading(prev=>({...prev,results:true}));try{const res=await fetch(\"http://localhost:3001/api/results\",{headers:{'Authorization':`Bearer ${localStorage.getItem('token')}`}});if(!res.ok)throw new Error(\"Échec du chargement des résultats\");const data=await res.json();setResults(data);}catch(err){console.error(\"Erreur lors du chargement des résultats:\",err);toast({title:\"Erreur\",description:\"Impossible de charger les résultats\",variant:\"destructive\"});}finally{setIsLoading(prev=>({...prev,results:false}));}};useEffect(()=>{fetchResults();},[]);const openScheduleExamDialog=async questionnaire=>{console.log(\"Questionnaire sélectionné :\",questionnaire);try{const res=await fetch(`http://localhost:3001/api/questionnaires/${questionnaire.id}/questions`);if(!res.ok){throw new Error(\"Impossible de récupérer les questions du questionnaire\");}const questions=await res.json();console.log(\"Questions liées au questionnaire :\",questions);const enrichedQuestionnaire={...questionnaire,questions};setSelectedQuestionnaire(enrichedQuestionnaire);setExamForm(prev=>({...prev,title:questionnaire.title,subject:questionnaire.subject}));setIsSchedulingExam(true);}catch(error){console.error(\"Erreur lors du chargement des questions :\",error);toast({title:\"Erreur\",description:\"Impossible de charger les questions du questionnaire\",variant:\"destructive\"});}};const handleApprove=async id=>{try{const res=await fetch(`http://localhost:3001/api/questionnaires/approve/${id}`,{method:\"POST\",headers:{\"Content-Type\":\"application/json\",'Authorization':`Bearer ${localStorage.getItem('token')}`}});if(!res.ok){const errorData=await res.json();throw new Error(errorData.message||\"Approval failed\");}setQuestionnaires(prev=>prev.map(q=>q.id===id?{...q,status:\"approved\"}:q));toast({title:\"Succès\",description:\"Questionnaire approuvé.\"});}catch(err){console.error(err);toast({title:\"Erreur\",description:err instanceof Error?err.message:\"Could not approve\",variant:\"destructive\"});}};const handleReject=async id=>{try{const res=await fetch(`http://localhost:3001/api/questionnaires/reject/${id}`,{method:\"POST\",headers:{\"Content-Type\":\"application/json\",'Authorization':`Bearer ${localStorage.getItem('token')}`}});if(!res.ok){const errorData=await res.json();throw new Error(errorData.message||\"Rejection failed\");}setQuestionnaires(prev=>prev.filter(q=>q.id!==id));toast({title:\"Rejeté\",description:\"Questionnaire rejeté.\"});}catch(err){console.error(err);toast({title:\"Erreur\",description:err instanceof Error?err.message:\"Could not reject\",variant:\"destructive\"});}};const validateExamForm=()=>{if(!examForm.title||!examForm.subject){toast({title:\"Erreur\",description:\"Le titre et la matière sont obligatoires\",variant:\"destructive\"});return false;}if(examForm.duration<=0){toast({title:\"Erreur\",description:\"La durée doit être positive\",variant:\"destructive\"});return false;}if(!examForm.startTime||!examForm.endTime){toast({title:\"Erreur\",description:\"Les dates de début et fin sont obligatoires\",variant:\"destructive\"});return false;}const now=new Date();const startDate=new Date(examForm.startTime);const endDate=new Date(examForm.endTime);if(startDate<=now){toast({title:\"Erreur\",description:\"La date de début doit être dans le futur\",variant:\"destructive\"});return false;}if(endDate<=startDate){toast({title:\"Erreur\",description:\"La date de fin doit être après la date de début\",variant:\"destructive\"});return false;}return true;};const scheduleExam=async()=>{if(!selectedQuestionnaire||!(user!==null&&user!==void 0&&user.faculty)){toast({title:\"Erreur\",description:\"Questionnaire ou faculté manquant\",variant:\"destructive\"});return;}if(!validateExamForm())return;try{const payload={title:examForm.title,subject:examForm.subject,duration:Number(examForm.duration),startTime:examForm.startTime,endTime:examForm.endTime,faculty:user.faculty,questionnaire_id:(selectedQuestionnaire===null||selectedQuestionnaire===void 0?void 0:selectedQuestionnaire.id)||null,questions:(selectedQuestionnaire===null||selectedQuestionnaire===void 0?void 0:selectedQuestionnaire.questions)||[],teacherId:selectedQuestionnaire===null||selectedQuestionnaire===void 0?void 0:selectedQuestionnaire.teacherId};console.log(\"Questions liées au questionnaire :\",selectedQuestionnaire===null||selectedQuestionnaire===void 0?void 0:selectedQuestionnaire.questions);console.log(\"payload envoyer:\",payload);const response=await fetch('http://localhost:3001/api/exams',{method:'POST',headers:{'Content-Type':'application/json','Authorization':`Bearer ${localStorage.getItem('token')}`},body:JSON.stringify(payload)});if(!response.ok){const errData=await response.json();throw new Error(errData.message||'Échec de la planification de l\\'examen');}const result=await response.json();toast({title:\"Succès\",description:\"Examen planifié avec succès\"});setIsSchedulingExam(false);fetchExams();}catch(error){console.error('Erreur lors de la planification:',error);toast({title:\"Erreur\",description:error instanceof Error?error.message:\"Échec de la planification de l'examen\",variant:\"destructive\"});}};const handleDeleteExam=async examId=>{if(!window.confirm(\"Voulez-vous vraiment supprimer cet examen ?\"))return;try{const res=await fetch(`http://localhost:3001/api/exams/${examId}`,{method:\"DELETE\",headers:{'Content-Type':'application/json','Authorization':`Bearer ${localStorage.getItem('token')}`}});if(!res.ok){const errorData=await res.json();throw new Error(errorData.message||\"Échec de la suppression de l'examen\");}setExams(prev=>prev.filter(ex=>ex.id!==examId));toast({title:\"Succès\",description:\"Examen supprimé avec succès\"});}catch(error){console.error(\"Erreur de suppression:\",error);toast({title:\"Erreur\",description:error instanceof Error?error.message:\"Impossible de supprimer l'examen\",variant:\"destructive\"});}};const exportResultsToExcel=()=>{try{const worksheet=XLSX.utils.json_to_sheet(results.map(result=>({\"ID Examen\":result.examId,\"Nom Étudiant\":result.studentName,\"Score\":result.score,\"Total Questions\":result.totalQuestions,\"Date de complétion\":new Date(result.completedAt).toLocaleString()})));const workbook=XLSX.utils.book_new();XLSX.utils.book_append_sheet(workbook,worksheet,\"Résultats\");XLSX.writeFile(workbook,\"resultats_examens.xlsx\");}catch(error){console.error(\"Erreur d'export:\",error);toast({title:\"Erreur d'export\",description:\"Impossible d'exporter les résultats\",variant:\"destructive\"});}};const stats={total:questionnaires.length,submitted:questionnaires.filter(q=>q.status===\"submitted\").length,approved:questionnaires.filter(q=>q.status===\"approved\").length,rejected:questionnaires.filter(q=>q.status===\"rejected\").length};const indexOfLastQuestionnaire=currentPage*itemsPerPage;const indexOfFirstQuestionnaire=indexOfLastQuestionnaire-itemsPerPage;const currentQuestionnaires=questionnaires.slice(indexOfFirstQuestionnaire,indexOfLastQuestionnaire);const renderFacultyMessage=()=>{switch(faculty){case\"informatique\":return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold\",children:\"Facult\\xE9 d'Informatique\"}),/*#__PURE__*/_jsx(\"p\",{children:\"G\\xE9rez les examens, utilisateurs et r\\xE9sultats pour l'informatique.\"})]});case\"polytechnique\":return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold\",children:\"Facult\\xE9 Polytechnique\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Administration des modules d'ing\\xE9nierie, gestion des enseignants et \\xE9tudiants.\"})]});case\"etudes-de-la-bible\":return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold\",children:\"Facult\\xE9 d'\\xC9tudes Bibliques\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Supervisez les examens bibliques et la formation des pasteurs.\"})]});case\"medecine\":return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold\",children:\"Facult\\xE9 de M\\xE9decine\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Planifiez les examens m\\xE9dicaux et organisez les stages hospitaliers.\"})]});case\"droit\":return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold\",children:\"Facult\\xE9 de Droit\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Contr\\xF4lez les examens de droit et les affectations des enseignants.\"})]});case\"sciences-economiques\":return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold\",children:\"Facult\\xE9 des Sciences \\xC9conomiques\"}),/*#__PURE__*/_jsx(\"p\",{children:\"G\\xE9rez le contenu relatif \\xE0 la comptabilit\\xE9, finance et \\xE9conomie.\"})]});default:return/*#__PURE__*/_jsx(\"div\",{className:\"text-red-600\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u26A0 Facult\\xE9 inconnue: \",/*#__PURE__*/_jsx(\"strong\",{children:faculty})]})});}};return/*#__PURE__*/_jsxs(\"div\",{className:\"dashbord-contrainer\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://i.postimg.cc/mZwbqh7Z/1752262954454.jpg\",alt:\"logo UPL\",width:\"60\",height:\"60\"}),/*#__PURE__*/_jsxs(\"h2\",{children:[\"Bienvenue \",user===null||user===void 0?void 0:user.name,\" \\uD83D\\uDC4B\"]}),renderFacultyMessage(),/*#__PURE__*/_jsx(QuestionnaireList,{faculty:user.faculty}),/*#__PURE__*/_jsxs(Button,{onClick:onLogout,variant:\"outline\",children:[/*#__PURE__*/_jsx(LogOut,{className:\"flex justify-end mb-4\"}),\" D\\xE9connexion\"]})]}),/*#__PURE__*/_jsxs(Tabs,{defaultValue:\"submitted\",children:[/*#__PURE__*/_jsxs(TabsList,{children:[/*#__PURE__*/_jsxs(TabsTrigger,{value:\"submitted\",children:[\"Soumis (\",stats.submitted,\")\"]}),/*#__PURE__*/_jsxs(TabsTrigger,{value:\"approved\",children:[\"Approuv\\xE9s (\",stats.approved,\")\"]}),/*#__PURE__*/_jsxs(TabsTrigger,{value:\"rejected\",children:[\"Rejet\\xE9s (\",stats.rejected,\")\"]}),/*#__PURE__*/_jsxs(TabsTrigger,{value:\"scheduled\",children:[\"Planifi\\xE9s (\",exams.length,\")\"]})]}),/*#__PURE__*/_jsxs(TabsContent,{value:\"submitted\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold my-4\",children:\"Questionnaires \\xE0 valider\"}),isLoading.questionnaires?/*#__PURE__*/_jsx(\"p\",{children:\"Chargement des questionnaires...\"}):currentQuestionnaires.filter(q=>q.status===\"submitted\").length===0?/*#__PURE__*/_jsx(\"p\",{children:\"Aucun questionnaire \\xE0 valider.\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\",children:currentQuestionnaires.filter(q=>q.status===\"submitted\").map(q=>{var _q$questions;return/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(CardHeader,{children:[/*#__PURE__*/_jsx(CardTitle,{children:q.title}),/*#__PURE__*/_jsxs(CardDescription,{children:[\"Mati\\xE8re: \",q.subject]})]}),/*#__PURE__*/_jsx(CardContent,{children:(_q$questions=q.questions)===null||_q$questions===void 0?void 0:_q$questions.map((question,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold\",children:[i+1,\". \",question.question]}),question.options.map((opt,idx)=>/*#__PURE__*/_jsxs(\"p\",{className:question.correctAnswer===idx?\"text-green-600\":\"text-gray-600\",children:[idx+1,\". \",opt]},idx))]},question.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between p-4\",children:[/*#__PURE__*/_jsx(Button,{onClick:()=>handleApprove(q.id),children:\"\\u2705 Approuver\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>handleReject(q.id),variant:\"destructive\",children:\"\\u274C Rejeter\"})]})]},q.id);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between mt-4\",children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setCurrentPage(prev=>Math.max(prev-1,1)),disabled:currentPage===1,children:\"Pr\\xE9c\\xE9dent\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>setCurrentPage(prev=>prev+1),disabled:indexOfLastQuestionnaire>=questionnaires.length,children:\"Suivant\"})]})]})]}),/*#__PURE__*/_jsxs(TabsContent,{value:\"approved\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold my-4\",children:\"Questionnaires approuv\\xE9s\"}),isLoading.questionnaires?/*#__PURE__*/_jsx(\"p\",{children:\"Chargement des questionnaires...\"}):questionnaires.filter(q=>q.status===\"approved\").length===0?/*#__PURE__*/_jsx(\"p\",{children:\"Aucun questionnaire approuv\\xE9.\"}):questionnaires.filter(q=>q.status===\"approved\").map(q=>/*#__PURE__*/_jsxs(Card,{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(CardHeader,{children:[/*#__PURE__*/_jsx(CardTitle,{children:q.title}),/*#__PURE__*/_jsxs(CardDescription,{children:[\"Mati\\xE8re: \",q.subject]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4 flex justify-end gap-2\",children:/*#__PURE__*/_jsx(Button,{onClick:()=>openScheduleExamDialog(q),variant:\"outline\",size:\"sm\",children:\"\\uD83D\\uDCC5 Planifier cet examen\"})})]},q.id))]}),/*#__PURE__*/_jsxs(TabsContent,{value:\"rejected\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold my-4\",children:\"Questionnaires rejet\\xE9s\"}),isLoading.questionnaires?/*#__PURE__*/_jsx(\"p\",{children:\"Chargement des questionnaires...\"}):questionnaires.filter(q=>q.status===\"rejected\").length===0?/*#__PURE__*/_jsx(\"p\",{children:\"Aucun questionnaire rejet\\xE9.\"}):questionnaires.filter(q=>q.status===\"rejected\").map(q=>/*#__PURE__*/_jsx(Card,{className:\"mb-4\",children:/*#__PURE__*/_jsxs(CardHeader,{children:[/*#__PURE__*/_jsx(CardTitle,{children:q.title}),/*#__PURE__*/_jsxs(CardDescription,{children:[\"Mati\\xE8re: \",q.subject]})]})},q.id))]}),/*#__PURE__*/_jsxs(TabsContent,{value:\"scheduled\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold my-4\",children:\"Examens planifi\\xE9s\"}),isLoading.exams?/*#__PURE__*/_jsx(\"p\",{children:\"Chargement des examens...\"}):exams.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:exams.map(exam=>/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(CardHeader,{children:[/*#__PURE__*/_jsx(CardTitle,{children:exam.title}),/*#__PURE__*/_jsxs(CardDescription,{children:[exam.subject,\" \\u2022 Dur\\xE9e: \",exam.duration,\" minutes\"]})]}),/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-sm\",children:[/*#__PURE__*/_jsx(Calendar,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsxs(\"span\",{children:[new Date(exam.startTime).toLocaleDateString(),\" \\u2022\",new Date(exam.startTime).toLocaleTimeString(),\" -\",new Date(exam.endTime).toLocaleTimeString()]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 flex justify-end\",children:/*#__PURE__*/_jsx(Button,{variant:\"destructive\",size:\"sm\",onClick:()=>handleDeleteExam(exam.id),children:\"Annuler l'examen\"})})]})]},exam.id))}):/*#__PURE__*/_jsx(\"p\",{children:\"Aucun examen planifi\\xE9 pour le moment.\"})]})]}),isSchedulingExam&&selectedQuestionnaire&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-50 bg-black bg-opacity-30 backdrop-blur-sm flex items-center justify-center p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-4xl bg-white rounded-2xl shadow-xl overflow-hidden animate-fadeIn\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-600 text-white px-6 py-4 flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold\",children:\"Planification d'examen\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsSchedulingExam(false),className:\"text-white hover:text-gray-200 text-2xl leading-none\",children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-8 space-y-6\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[\"Questionnaire s\\xE9lectionn\\xE9 : \",/*#__PURE__*/_jsx(\"strong\",{children:selectedQuestionnaire.title})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{className:\"text-sm font-medium text-gray-700\",children:\"Titre\"}),/*#__PURE__*/_jsx(Input,{value:examForm.title,onChange:e=>setExamForm({...examForm,title:e.target.value}),placeholder:\"Ex: Examen de mi-parcours\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{className:\"text-sm font-medium text-gray-700\",children:\"Mati\\xE8re\"}),/*#__PURE__*/_jsx(Input,{value:examForm.subject,onChange:e=>setExamForm({...examForm,subject:e.target.value}),placeholder:\"Ex: Math\\xE9matiques\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{className:\"text-sm font-medium text-gray-700\",children:\"Dur\\xE9e (en minutes)\"}),/*#__PURE__*/_jsx(Input,{type:\"number\",min:\"1\",value:examForm.duration,onChange:e=>setExamForm({...examForm,duration:parseInt(e.target.value)||60}),placeholder:\"60\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{className:\"text-sm font-medium text-gray-700\",children:\"D\\xE9but\"}),/*#__PURE__*/_jsx(Input,{type:\"datetime-local\",value:examForm.startTime,onChange:e=>setExamForm({...examForm,startTime:e.target.value})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{className:\"text-sm font-medium text-gray-700\",children:\"Fin\"}),/*#__PURE__*/_jsx(Input,{type:\"datetime-local\",value:examForm.endTime,onChange:e=>setExamForm({...examForm,endTime:e.target.value})})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-100 px-6 py-4 flex justify-end gap-4\",children:[/*#__PURE__*/_jsx(Button,{variant:\"outline\",onClick:()=>setIsSchedulingExam(false),children:\"Annuler\"}),/*#__PURE__*/_jsx(Button,{onClick:scheduleExam,className:\"bg-blue-600 hover:bg-blue-700 text-white\",children:\"Planifier\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold\",children:\"R\\xE9sultats des \\xC9tudiants\"}),/*#__PURE__*/_jsxs(Button,{onClick:exportResultsToExcel,variant:\"outline\",className:\"bg-blue-500 text-white hover:bg-blue-600\",disabled:results.length===0,children:[/*#__PURE__*/_jsx(Download,{className:\"w-4 h-4 mr-2\"}),\"Exporter vers Excel\"]})]}),isLoading.results?/*#__PURE__*/_jsx(\"p\",{children:\"Chargement des r\\xE9sultats...\"}):results.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"Aucun r\\xE9sultat re\\xE7u pour le moment.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full bg-white rounded shadow\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"bg-gray-200\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left\",children:\"\\xC9tudiant\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left\",children:\"Examen\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left\",children:\"Score\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left\",children:\"Questions\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left\",children:\"Date\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:results.map((result,idx)=>{var _exams$find;return/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-2\",children:result.userName}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-2\",children:((_exams$find=exams.find(e=>e.id===result.examId))===null||_exams$find===void 0?void 0:_exams$find.title)||result.examId}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-2\",children:[result.score,\"%\"]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-2\",children:[Math.round(result.score*result.totalQuestions/100),\"/\",result.totalQuestions]}),/*#__PURE__*/_jsx(\"td\",{children:result.submitted_at?new Date(result.submitted_at).toLocaleString():\"Date non disponible\"})]},idx);})})]})})]})]});};export default AdminDashboard;","map":{"version":3,"names":["React","useEffect","useState","useParams","useUser","QuestionnaireList","Card","CardContent","CardDescription","CardHeader","CardTitle","Button","Input","Label","Tabs","TabsContent","TabsList","TabsTrigger","LogOut","Calendar","Download","useToast","XLSX","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AdminDashboard","_ref","user","onLogout","formatDate","dateString","date","Date","isNaN","getTime","toLocaleString","faculty","setUser","questionnaires","setQuestionnaires","exams","setExams","results","setResults","selectedQuestionnaire","setSelectedQuestionnaire","examForm","setExamForm","duration","startTime","endTime","title","subject","isSchedulingExam","setIsSchedulingExam","currentPage","setCurrentPage","itemsPerPage","isLoading","setIsLoading","users","toast","fetchExams","prev","res","fetch","ok","Error","data","json","error","console","description","variant","fetchQuestionnaires","headers","localStorage","getItem","err","fetchResults","openScheduleExamDialog","questionnaire","log","id","questions","enrichedQuestionnaire","handleApprove","method","errorData","message","map","q","status","handleReject","filter","validateExamForm","now","startDate","endDate","scheduleExam","payload","Number","questionnaire_id","teacherId","response","body","JSON","stringify","errData","result","handleDeleteExam","examId","window","confirm","ex","exportResultsToExcel","worksheet","utils","json_to_sheet","studentName","score","totalQuestions","completedAt","workbook","book_new","book_append_sheet","writeFile","stats","total","length","submitted","approved","rejected","indexOfLastQuestionnaire","indexOfFirstQuestionnaire","currentQuestionnaires","slice","renderFacultyMessage","children","className","src","alt","width","height","name","onClick","defaultValue","value","_q$questions","question","i","options","opt","idx","correctAnswer","Math","max","disabled","size","exam","toLocaleDateString","toLocaleTimeString","onChange","e","target","placeholder","type","min","parseInt","_exams$find","userName","find","round","submitted_at"],"sources":["C:/Users/HP/Desktop/upl.patforme/frontend/src/pages/AdminDashboard.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { useUser } from \"../contexts/UserContext\";\r\nimport QuestionnaireList from \"../components/QuestionnaireList\";\r\nimport \"./admi.css\"\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from \"../components/ui/card\";\r\nimport { Button } from \"../components/ui/button\";\r\nimport { Input } from \"../components/ui/input\";\r\nimport { Label } from \"../components/ui/label\";\r\nimport { Badge } from \"../components/ui/badge\";\r\nimport {\r\n  Tabs,\r\n  TabsContent,\r\n  TabsList,\r\n  TabsTrigger,\r\n} from \"../components/ui/tabs\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"../components/ui/dialog\";\r\nimport {\r\n  LogOut,\r\n  CheckCircle,\r\n  XCircle,\r\n  Calendar,\r\n  Clock,\r\n  Download,\r\n  Users,\r\n  FileText,\r\n  BarChart3,\r\n} from \"lucide-react\";\r\nimport { useToast } from \"../hooks/use-toast\";\r\nimport * as XLSX from \"xlsx\";\r\nimport { useNavigate } from \"react-router-dom\";\r\ninterface User {\r\n  id: string;\r\n  name: string;\r\n  role: string;\r\n  faculty: string;\r\n}\r\n\r\ninterface Question {\r\n  id: string;\r\n  question: string;\r\n  options: string[];\r\n  correctAnswer: number;\r\n}\r\n\r\ninterface Questionnaire {\r\n  id: string;\r\n  title: string;\r\n  subject: string;\r\n  questions: Question[];\r\n  status: \"draft\" | \"submitted\" | \"approved\" | \"rejected\";\r\n  submittedAt?: string;\r\n  teacherId: string;\r\n  teacherName?: string;\r\n}\r\n\r\ninterface Exam {\r\n  id: string;\r\n  title: string;\r\n  subject: string;\r\n  duration: number;\r\n  startTime: string;\r\n  endTime: string;\r\n  questions: Question[];\r\n  status: \"upcoming\" | \"active\" | \"completed\";\r\n  questionnaireId: string;\r\n  faculty: string;\r\n}\r\n\r\ninterface ExamResult {\r\n  userName: string;\r\n  id: string;\r\n  examId: string;\r\n  studentId: string;\r\n  studentName: string;\r\n  score: number;\r\n  totalQuestions: number;\r\n  completedAt: string;\r\n    submitted_at: string;\r\n  answers: { [key: string]: number };\r\n}\r\n\r\ninterface AdminDashboardProps {\r\n  user: User;\r\n  onLogout: () => void;\r\n}\r\n\r\n\r\nconst AdminDashboard: React.FC<AdminDashboardProps> = ({ user, onLogout }) => {\r\n  const formatDate = (dateString: string | null | undefined) => {\r\n  if (!dateString) return \"Date non disponible\";\r\n  const date = new Date(dateString);\r\n  return isNaN(date.getTime()) ? \"Date invalide\" : date.toLocaleString();\r\n};\r\n\r\n\r\n\r\n\r\n  const { faculty } = useParams();\r\n  const { setUser } = useUser();\r\n  const [questionnaires, setQuestionnaires] = useState<Questionnaire[]>([]);\r\n  const [exams, setExams] = useState<Exam[]>([]);\r\n  const [results, setResults] = useState<ExamResult[]>([]);\r\n  const [selectedQuestionnaire, setSelectedQuestionnaire] = useState<Questionnaire | null>(null);\r\n  const [examForm, setExamForm] = useState({ \r\n    duration: 60, \r\n    startTime: \"\", \r\n    endTime: \"\",\r\n    title: \"\",\r\n    subject: \"\"\r\n    \r\n  });\r\n  \r\n  const [isSchedulingExam, setIsSchedulingExam] = useState(false);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [itemsPerPage] = useState(5);\r\n  const [isLoading, setIsLoading] = useState({\r\n    exams: false,\r\n    questionnaires: false,\r\n    results: false,\r\n    users: false\r\n  });\r\n  const { toast } = useToast();\r\n  \r\n\r\n  const fetchExams = async () => {\r\n    setIsLoading(prev => ({...prev, exams: true}));\r\n    try {\r\n      const res = await fetch(`http://localhost:3001/api/exams?faculty=${user.faculty}`); \r\n    \r\n      if (!res.ok) throw new Error(\"Échec du chargement des examens\");\r\n      const data = await res.json();\r\n      setExams(data);\r\n    } catch (error) {\r\n      console.error(\"Erreur lors du chargement des examens:\", error);\r\n      toast({\r\n        title: \"Erreur\",\r\n        description: \"Impossible de charger les examens\",\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsLoading(prev => ({...prev, exams: false}));\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchExams();\r\n  }, []);\r\n\r\n  const fetchQuestionnaires = async () => {\r\n    setIsLoading(prev => ({...prev, questionnaires: true}));\r\n    try {\r\n      const res = await fetch(\"http://localhost:3001/api/questionnaires/submitted\", {\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\r\n        }\r\n      });\r\n      if (!res.ok) throw new Error(\"Échec du chargement des questionnaires\");\r\n      const data = await res.json();\r\n      setQuestionnaires(data);\r\n    } catch (err) {\r\n      console.error(\"Erreur de chargement:\", err);\r\n      toast({\r\n        title: \"Erreur\",\r\n        description: \"Impossible de charger les questionnaires\",\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsLoading(prev => ({...prev, questionnaires: false}));\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchQuestionnaires();\r\n  }, []);\r\n\r\n  const fetchResults = async () => {\r\n    setIsLoading(prev => ({...prev, results: true}));\r\n    try {\r\n      const res = await fetch(\"http://localhost:3001/api/results\", {\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\r\n        }\r\n      });\r\n      if (!res.ok) throw new Error(\"Échec du chargement des résultats\");\r\n      const data = await res.json();\r\n      setResults(data);\r\n    } catch (err) {\r\n      console.error(\"Erreur lors du chargement des résultats:\", err);\r\n      toast({\r\n        title: \"Erreur\",\r\n        description: \"Impossible de charger les résultats\",\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsLoading(prev => ({...prev, results: false}));\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchResults();\r\n  }, []);\r\n\r\nconst openScheduleExamDialog = async (questionnaire: Questionnaire) => {\r\n  console.log(\"Questionnaire sélectionné :\", questionnaire);\r\n\r\n  try {\r\n    const res = await fetch(`http://localhost:3001/api/questionnaires/${questionnaire.id}/questions`);\r\n    if (!res.ok) {\r\n      throw new Error(\"Impossible de récupérer les questions du questionnaire\");\r\n    }\r\n\r\n    const questions = await res.json();\r\n    console.log(\"Questions liées au questionnaire :\", questions);\r\n\r\n    const enrichedQuestionnaire = {\r\n      ...questionnaire,\r\n      questions\r\n    };\r\n\r\n    setSelectedQuestionnaire(enrichedQuestionnaire);\r\n    setExamForm(prev => ({\r\n      ...prev,\r\n      title: questionnaire.title,\r\n      subject: questionnaire.subject\r\n    }));\r\n    setIsSchedulingExam(true);\r\n\r\n  } catch (error) {\r\n    console.error(\"Erreur lors du chargement des questions :\", error);\r\n    toast({\r\n      title: \"Erreur\",\r\n      description: \"Impossible de charger les questions du questionnaire\",\r\n      variant: \"destructive\"\r\n    });\r\n  }\r\n    \r\n};\r\n  const handleApprove = async (id: string) => {\r\n    try {\r\n      const res = await fetch(`http://localhost:3001/api/questionnaires/approve/${id}`, {\r\n        method: \"POST\",\r\n        headers: { \r\n          \"Content-Type\": \"application/json\",\r\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\r\n        },\r\n      });\r\n      \r\n      if (!res.ok) {\r\n        const errorData = await res.json();\r\n        throw new Error(errorData.message || \"Approval failed\");\r\n      }\r\n      \r\n      setQuestionnaires(prev => prev.map(q => q.id === id ? { ...q, status: \"approved\" } : q));\r\n      toast({ title: \"Succès\", description: \"Questionnaire approuvé.\" });\r\n    } catch (err) {\r\n      console.error(err);\r\n      toast({ \r\n        title: \"Erreur\", \r\n        description: err instanceof Error ? err.message : \"Could not approve\", \r\n        variant: \"destructive\" \r\n      });\r\n    }\r\n  };\r\n\r\n  const handleReject = async (id: string) => {\r\n    try {\r\n      const res = await fetch(`http://localhost:3001/api/questionnaires/reject/${id}`, {\r\n        method: \"POST\",\r\n        headers: { \r\n          \"Content-Type\": \"application/json\",\r\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\r\n        },\r\n      });\r\n      \r\n      if (!res.ok) {\r\n        const errorData = await res.json();\r\n        throw new Error(errorData.message || \"Rejection failed\");\r\n      }\r\n      \r\n      setQuestionnaires(prev => prev.filter(q => q.id !== id));\r\n      toast({ title: \"Rejeté\", description: \"Questionnaire rejeté.\" });\r\n    } catch (err) {\r\n      console.error(err);\r\n      toast({ \r\n        title: \"Erreur\", \r\n        description: err instanceof Error ? err.message : \"Could not reject\", \r\n        variant: \"destructive\" \r\n      });\r\n    }\r\n  };\r\n\r\n  const validateExamForm = (): boolean => {\r\n    if (!examForm.title || !examForm.subject) {\r\n      toast({\r\n        title: \"Erreur\",\r\n        description: \"Le titre et la matière sont obligatoires\",\r\n        variant: \"destructive\",\r\n      });\r\n      return false;\r\n    }\r\n\r\n    if (examForm.duration <= 0) {\r\n      toast({\r\n        title: \"Erreur\",\r\n        description: \"La durée doit être positive\",\r\n        variant: \"destructive\",\r\n      });\r\n      return false;\r\n    }\r\n\r\n    if (!examForm.startTime || !examForm.endTime) {\r\n      toast({\r\n        title: \"Erreur\",\r\n        description: \"Les dates de début et fin sont obligatoires\",\r\n        variant: \"destructive\",\r\n      });\r\n      return false;\r\n    }\r\n\r\n    const now = new Date();\r\n    const startDate = new Date(examForm.startTime);\r\n    const endDate = new Date(examForm.endTime);\r\n\r\n    if (startDate <= now) {\r\n      toast({\r\n        title: \"Erreur\",\r\n        description: \"La date de début doit être dans le futur\",\r\n        variant: \"destructive\",\r\n      });\r\n      return false;\r\n    }\r\n\r\n    if (endDate <= startDate) {\r\n      toast({\r\n        title: \"Erreur\",\r\n        description: \"La date de fin doit être après la date de début\",\r\n        variant: \"destructive\",\r\n      });\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const scheduleExam = async () => {\r\n    if (!selectedQuestionnaire || !user?.faculty) {\r\n      toast({\r\n        title: \"Erreur\",\r\n        description: \"Questionnaire ou faculté manquant\",\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (!validateExamForm()) return;\r\n\r\n    try {\r\n      const payload = {\r\n        title: examForm.title,\r\n        subject: examForm.subject,\r\n        duration: Number(examForm.duration),\r\n        startTime: examForm.startTime,\r\n        endTime: examForm.endTime,\r\n        faculty: user.faculty,\r\n        questionnaire_id: selectedQuestionnaire?.id|| null,\r\n        questions: selectedQuestionnaire?.questions|| [],\r\n        teacherId: selectedQuestionnaire?.teacherId\r\n      };\r\n      console.log(\"Questions liées au questionnaire :\", selectedQuestionnaire?.questions);\r\n\r\n      console .log (\"payload envoyer:\",payload)\r\n      \r\n\r\n      const response = await fetch('http://localhost:3001/api/exams', {\r\n        method: 'POST',\r\n        headers: { \r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\r\n        },\r\n        body: JSON.stringify(payload),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errData = await response.json();\r\n        throw new Error(errData.message || 'Échec de la planification de l\\'examen');\r\n      }\r\n\r\n      const result = await response.json();\r\n      toast({\r\n        title: \"Succès\",\r\n        description: \"Examen planifié avec succès\",\r\n      });\r\n      setIsSchedulingExam(false);\r\n      fetchExams();\r\n    } catch (error) {\r\n      console.error('Erreur lors de la planification:', error);\r\n      toast({\r\n        title: \"Erreur\",\r\n        description: error instanceof Error ? error.message : \"Échec de la planification de l'examen\",\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleDeleteExam = async (examId: string) => {\r\n    if (!window.confirm(\"Voulez-vous vraiment supprimer cet examen ?\")) return;\r\n\r\n    try {\r\n      const res = await fetch(`http://localhost:3001/api/exams/${examId}`, {\r\n        method: \"DELETE\",\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\r\n        }\r\n      });\r\n      \r\n      if (!res.ok) {\r\n        const errorData = await res.json();\r\n        throw new Error(errorData.message || \"Échec de la suppression de l'examen\");\r\n      }\r\n\r\n      setExams(prev => prev.filter(ex => ex.id !== examId));\r\n      toast({ \r\n        title: \"Succès\", \r\n        description: \"Examen supprimé avec succès\" \r\n      });\r\n    } catch (error) {\r\n      console.error(\"Erreur de suppression:\", error);\r\n      toast({ \r\n        title: \"Erreur\", \r\n        description: error instanceof Error ? error.message : \"Impossible de supprimer l'examen\",\r\n        variant: \"destructive\" \r\n      });\r\n    }\r\n  };\r\n\r\n  const exportResultsToExcel = () => {\r\n    try {\r\n      const worksheet = XLSX.utils.json_to_sheet(results.map(result => ({\r\n        \"ID Examen\": result.examId,\r\n        \"Nom Étudiant\": result.studentName,\r\n        \"Score\": result.score,\r\n        \"Total Questions\": result.totalQuestions,\r\n        \"Date de complétion\": new Date(result.completedAt).toLocaleString(),\r\n      })));\r\n\r\n      const workbook = XLSX.utils.book_new();\r\n      XLSX.utils.book_append_sheet(workbook, worksheet, \"Résultats\");\r\n      XLSX.writeFile(workbook, \"resultats_examens.xlsx\");\r\n    } catch (error) {\r\n      console.error(\"Erreur d'export:\", error);\r\n      toast({\r\n        title: \"Erreur d'export\",\r\n        description: \"Impossible d'exporter les résultats\",\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  const stats = {\r\n    total: questionnaires.length,\r\n    submitted: questionnaires.filter(q => q.status === \"submitted\").length,\r\n    approved: questionnaires.filter(q => q.status === \"approved\").length,\r\n    rejected: questionnaires.filter(q => q.status === \"rejected\").length,\r\n  };\r\n\r\n  const indexOfLastQuestionnaire = currentPage * itemsPerPage;\r\n  const indexOfFirstQuestionnaire = indexOfLastQuestionnaire - itemsPerPage;\r\n  const currentQuestionnaires = questionnaires.slice(\r\n    indexOfFirstQuestionnaire, \r\n    indexOfLastQuestionnaire\r\n  );\r\n\r\n  const renderFacultyMessage = () => {\r\n    switch (faculty) {\r\n      case \"informatique\":\r\n        return (\r\n          <div>\r\n            <h2 className=\"text-lg font-semibold\">Faculté d'Informatique</h2>\r\n            <p>Gérez les examens, utilisateurs et résultats pour l'informatique.</p>\r\n          </div>\r\n        );\r\n      case \"polytechnique\":\r\n        return (\r\n          <div>\r\n            <h2 className=\"text-lg font-semibold\">Faculté Polytechnique</h2>\r\n            <p>Administration des modules d'ingénierie, gestion des enseignants et étudiants.</p>\r\n          </div>\r\n        );\r\n      case \"etudes-de-la-bible\":\r\n        return (\r\n          <div>\r\n            <h2 className=\"text-lg font-semibold\">Faculté d'Études Bibliques</h2>\r\n            <p>Supervisez les examens bibliques et la formation des pasteurs.</p>\r\n          </div>\r\n        );\r\n      case \"medecine\":\r\n        return (\r\n          <div>\r\n            <h2 className=\"text-lg font-semibold\">Faculté de Médecine</h2>\r\n            <p>Planifiez les examens médicaux et organisez les stages hospitaliers.</p>\r\n          </div>\r\n        );\r\n      case \"droit\":\r\n        return (\r\n          <div>\r\n            <h2 className=\"text-lg font-semibold\">Faculté de Droit</h2>\r\n            <p>Contrôlez les examens de droit et les affectations des enseignants.</p>\r\n          </div>\r\n        );\r\n      case \"sciences-economiques\":\r\n        return (\r\n          <div>\r\n            <h2 className=\"text-lg font-semibold\">Faculté des Sciences Économiques</h2>\r\n            <p>Gérez le contenu relatif à la comptabilité, finance et économie.</p>\r\n          </div>\r\n        );\r\n      default:\r\n        return (\r\n          <div className=\"text-red-600\">\r\n            <p>⚠ Faculté inconnue: <strong>{faculty}</strong></p>\r\n          </div>\r\n        );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"dashbord-contrainer\">\r\n      <div className=\"p-6\">\r\n          <img src=\"https://i.postimg.cc/mZwbqh7Z/1752262954454.jpg\"alt=\"logo UPL\" width=\"60\" height=\"60\" ></img>\r\n        <h2>Bienvenue {user?.name} 👋</h2>\r\n\r\n        {renderFacultyMessage()}\r\n        <QuestionnaireList faculty={user.faculty} />\r\n             <Button onClick={onLogout} variant=\"outline\">\r\n          <LogOut className=\"flex justify-end mb-4\" /> Déconnexion\r\n        </Button>\r\n      </div>\r\n      <Tabs defaultValue=\"submitted\">\r\n        <TabsList>\r\n          <TabsTrigger value=\"submitted\">Soumis ({stats.submitted})</TabsTrigger>\r\n          <TabsTrigger value=\"approved\">Approuvés ({stats.approved})</TabsTrigger>\r\n          <TabsTrigger value=\"rejected\">Rejetés ({stats.rejected})</TabsTrigger>\r\n          <TabsTrigger value=\"scheduled\">Planifiés ({exams.length})</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"submitted\">\r\n          <h2 className=\"text-xl font-semibold my-4\">Questionnaires à valider</h2>\r\n          {isLoading.questionnaires ? (\r\n            <p>Chargement des questionnaires...</p>\r\n          ) : currentQuestionnaires.filter(q => q.status === \"submitted\").length === 0 ? (\r\n            <p>Aucun questionnaire à valider.</p>\r\n          ) : (\r\n            <>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                {currentQuestionnaires\r\n                  .filter(q => q.status === \"submitted\")\r\n                  .map(q => (\r\n                    <Card key={q.id}>\r\n                      <CardHeader>\r\n                        <CardTitle>{q.title}</CardTitle>\r\n                        <CardDescription>Matière: {q.subject}</CardDescription>\r\n                      </CardHeader>\r\n                      <CardContent>\r\n                        {q.questions?.map((question, i) => (\r\n                          <div key={question.id} className=\"mb-2\">\r\n                            <p className=\"font-semibold\">{i + 1}. {question.question}</p>\r\n                            {question.options.map((opt, idx) => (\r\n                              <p \r\n                                key={idx} \r\n                                className={question.correctAnswer === idx ? \"text-green-600\" : \"text-gray-600\"}\r\n                              >\r\n                                {idx + 1}. {opt}\r\n                              </p>\r\n                            ))}\r\n                          </div>\r\n                        ))}\r\n                      </CardContent>\r\n                      <div className=\"flex justify-between p-4\">\r\n                        <Button onClick={() => handleApprove(q.id)}>✅ Approuver</Button>\r\n                        <Button onClick={() => handleReject(q.id)} variant=\"destructive\">❌ Rejeter</Button>\r\n                      </div>\r\n                    </Card>\r\n                  ))}\r\n              </div>\r\n              <div className=\"flex justify-between mt-4\">\r\n                <Button \r\n                  onClick={() => setCurrentPage(prev => Math.max(prev - 1, 1))} \r\n                  disabled={currentPage === 1}\r\n                >\r\n                  Précédent\r\n                </Button>\r\n                <Button \r\n                  onClick={() => setCurrentPage(prev => prev + 1)} \r\n                  disabled={indexOfLastQuestionnaire >= questionnaires.length}\r\n                >\r\n                  Suivant\r\n                </Button>\r\n              </div>\r\n            </>\r\n          )}\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"approved\">\r\n          <h2 className=\"text-xl font-semibold my-4\">Questionnaires approuvés</h2>\r\n          {isLoading.questionnaires ? (\r\n            <p>Chargement des questionnaires...</p>\r\n          ) : questionnaires.filter(q => q.status === \"approved\").length === 0 ? (\r\n            <p>Aucun questionnaire approuvé.</p>\r\n          ) : (\r\n            questionnaires\r\n              .filter(q => q.status === \"approved\")\r\n              .map(q => (\r\n                <Card key={q.id} className=\"mb-4\">\r\n                  <CardHeader>\r\n                    <CardTitle>{q.title}</CardTitle>\r\n                    <CardDescription>Matière: {q.subject}</CardDescription>\r\n                  </CardHeader>\r\n                  <div className=\"p-4 flex justify-end gap-2\">\r\n                    <Button \r\n                      onClick={() => openScheduleExamDialog(q)} \r\n                      variant=\"outline\" \r\n                      size=\"sm\"\r\n                    >\r\n                      📅 Planifier cet examen\r\n                    </Button>\r\n                  </div>\r\n                </Card>\r\n              ))\r\n          )}\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"rejected\">\r\n          <h2 className=\"text-xl font-semibold my-4\">Questionnaires rejetés</h2>\r\n          {isLoading.questionnaires ? (\r\n            <p>Chargement des questionnaires...</p>\r\n          ) : questionnaires.filter(q => q.status === \"rejected\").length === 0 ? (\r\n            <p>Aucun questionnaire rejeté.</p>\r\n          ) : (\r\n            questionnaires\r\n              .filter(q => q.status === \"rejected\")\r\n              .map(q => (\r\n                <Card key={q.id} className=\"mb-4\">\r\n                  <CardHeader>\r\n                    <CardTitle>{q.title}</CardTitle>\r\n                    <CardDescription>Matière: {q.subject}</CardDescription>\r\n                  </CardHeader>\r\n                </Card>\r\n              ))\r\n          )}\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"scheduled\">\r\n          <h2 className=\"text-xl font-semibold my-4\">Examens planifiés</h2>\r\n          {isLoading.exams ? (\r\n            <p>Chargement des examens...</p>\r\n          ) : exams.length > 0 ? (\r\n            <div className=\"space-y-4\">\r\n              {exams.map(exam => (\r\n                <Card key={exam.id}>\r\n                  <CardHeader>\r\n                    <CardTitle>{exam.title}</CardTitle>\r\n                    <CardDescription>\r\n                      {exam.subject} • Durée: {exam.duration} minutes\r\n                    </CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"flex items-center gap-2 text-sm\">\r\n                      <Calendar className=\"w-4 h-4\" />\r\n                      <span>\r\n                        {new Date(exam.startTime).toLocaleDateString()} • \r\n                        {new Date(exam.startTime).toLocaleTimeString()} - \r\n                        {new Date(exam.endTime).toLocaleTimeString()}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"mt-4 flex justify-end\">\r\n                      <Button \r\n                        variant=\"destructive\" \r\n                        size=\"sm\"\r\n                        onClick={() => handleDeleteExam(exam.id)}\r\n                      >\r\n                        Annuler l'examen\r\n                      </Button>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <p>Aucun examen planifié pour le moment.</p>\r\n          )}\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* Dialogue de planification d'examen */}\r\n    \r\n        {isSchedulingExam && selectedQuestionnaire && (\r\n  <div className=\"fixed inset-0 z-50 bg-black bg-opacity-30 backdrop-blur-sm flex items-center justify-center p-4\">\r\n    <div className=\"w-full max-w-4xl bg-white rounded-2xl shadow-xl overflow-hidden animate-fadeIn\">\r\n      \r\n      {/* Header */}\r\n      <div className=\"bg-blue-600 text-white px-6 py-4 flex justify-between items-center\">\r\n        <h2 className=\"text-xl font-semibold\">Planification d'examen</h2>\r\n        <button\r\n          onClick={() => setIsSchedulingExam(false)}\r\n          className=\"text-white hover:text-gray-200 text-2xl leading-none\"\r\n        >\r\n          &times;\r\n        </button>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className=\"px-6 py-8 space-y-6\">\r\n        <p className=\"text-sm text-gray-500\">\r\n          Questionnaire sélectionné : <strong>{selectedQuestionnaire.title}</strong>\r\n        </p>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n          <div>\r\n            <Label className=\"text-sm font-medium text-gray-700\">Titre</Label>\r\n            <Input\r\n              value={examForm.title}\r\n              onChange={(e) => setExamForm({ ...examForm, title: e.target.value })}\r\n              placeholder=\"Ex: Examen de mi-parcours\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <Label className=\"text-sm font-medium text-gray-700\">Matière</Label>\r\n            <Input\r\n              value={examForm.subject}\r\n              onChange={(e) => setExamForm({ ...examForm, subject: e.target.value })}\r\n              placeholder=\"Ex: Mathématiques\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <Label className=\"text-sm font-medium text-gray-700\">Durée (en minutes)</Label>\r\n            <Input\r\n              type=\"number\"\r\n              min=\"1\"\r\n              value={examForm.duration}\r\n              onChange={(e) =>\r\n                setExamForm({ ...examForm, duration: parseInt(e.target.value) || 60 })\r\n              }\r\n              placeholder=\"60\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <Label className=\"text-sm font-medium text-gray-700\">Début</Label>\r\n            <Input\r\n              type=\"datetime-local\"\r\n              value={examForm.startTime}\r\n              onChange={(e) => setExamForm({ ...examForm, startTime: e.target.value })}\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <Label className=\"text-sm font-medium text-gray-700\">Fin</Label>\r\n            <Input\r\n              type=\"datetime-local\"\r\n              value={examForm.endTime}\r\n              onChange={(e) => setExamForm({ ...examForm, endTime: e.target.value })}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Footer */}\r\n      <div className=\"bg-gray-100 px-6 py-4 flex justify-end gap-4\">\r\n        <Button variant=\"outline\" onClick={() => setIsSchedulingExam(false)}>\r\n          Annuler\r\n        </Button>\r\n        <Button onClick={scheduleExam} className=\"bg-blue-600 hover:bg-blue-700 text-white\">\r\n          Planifier\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n)}\r\n\r\n\r\n      {/* Section Résultats */}\r\n      <div className=\"mt-8\">\r\n        <div className=\"flex justify-between items-center mb-4\">\r\n          <h2 className=\"text-xl font-bold\">Résultats des Étudiants</h2>\r\n          <Button \r\n            onClick={exportResultsToExcel} \r\n            variant=\"outline\" \r\n            className=\"bg-blue-500 text-white hover:bg-blue-600\"\r\n            disabled={results.length === 0}\r\n          >\r\n            <Download className=\"w-4 h-4 mr-2\" />\r\n            Exporter vers Excel\r\n          </Button>\r\n        </div>\r\n\r\n        {isLoading.results ? (\r\n          <p>Chargement des résultats...</p>\r\n        ) : results.length === 0 ? (\r\n          <p>Aucun résultat reçu pour le moment.</p>\r\n        ) : (\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"min-w-full bg-white rounded shadow\">\r\n              <thead>\r\n                <tr className=\"bg-gray-200\">\r\n                  <th className=\"px-4 py-2 text-left\">Étudiant</th>\r\n                  <th className=\"px-4 py-2 text-left\">Examen</th>\r\n                  <th className=\"px-4 py-2 text-left\">Score</th>\r\n                  <th className=\"px-4 py-2 text-left\">Questions</th>\r\n                  <th className=\"px-4 py-2 text-left\">Date</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {results.map((result, idx) => (\r\n                  <tr key={idx} className=\"border-b hover:bg-gray-50\">\r\n                    <td className=\"px-4 py-2\">{result.userName}</td>\r\n                    <td className=\"px-4 py-2\">\r\n                      {exams.find(e => e.id === result.examId)?.title || result.examId}\r\n                    </td>\r\n                    <td className=\"px-4 py-2\">{result.score}%</td>\r\n                    <td className=\"px-4 py-2\">\r\n                      {Math.round((result.score * result.totalQuestions) / 100)}/{result.totalQuestions}\r\n                    </td>\r\n                   <td>\r\n                         {result.submitted_at\r\n                        ? new Date(result.submitted_at).toLocaleString()\r\n                           : \"Date non disponible\"}\r\n                  </td>\r\n\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminDashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}